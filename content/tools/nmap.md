---
tags:
  - tool
  - general
aliases:
---
## Automation Tools
- [[AutoRecon]]
- [[nmapautomator]]
## Pre-made commands
##### SYN scan (TCP) (sudo)
This method reports if there is an application listening on the target port and does not register on the host system, because no ACK is sent to the target. This method does not retrieve any information about the service.
```shell
sudo nmap -sS {IP Address}
```
##### Full connect scan
The advantage of this method is that a fully functional connection to the target host is made which allows information to be gathered from the listening service (aka banner grabbing).
```shell
nmap –sT –sV 10.16.32.23
```
##### Null Scan (sudo)
This scan is useful to penetrate firewalls and routers set to filter certain flags out since it uses no flags. Open and filtered ports should have no response, filtered ports may also send an ICMP unreachable message, and closed ports should send a RST packet.
```shell
nmap -sN 10.50.1.1
```
##### FIN scan (sudo)
Like the null scan it works to go through firewalls and routers, in addition to being considered stealthier due to the illegal flag combination. Open and filtered ports should have no response, filtered ports may also send an ICMP unreachable message, and closed ports should send a RST packet.
```shell
nmap -sF 25.50.75.100
```
##### XMAS tree scan (sudo)
Open and filtered ports should have no response, filtered ports may also send an ICMP unreachable message, and closed ports should send a RST packet.
```shell
nmap -sX 7.92.5.19
```
##### UDP scan
A UDP Scan can be used to find nix hosts that are blocking TCP and ICMP traffic. Since UDP is a stateless protocol it is often used to get through stateful firewalls. This kind of scan is not very useful for service discovery because UDP is connection-less.
```shell
 nmap –sU -v 10.10.100.3
```
##### RPC Scan
A RPC scan is looking for services that use RPC (remote Procedure Call). RPC allows for remote commands to be run on machines and this scan will determine the services and version of the service when run.
```shell
nmap -sR 10.50.22.29
```
##### OS fingerprinting scan
By sending TCP and UDP packets it gathers information such as window size, TCP option ordering and IP ID sampling. It runs that information against its OS database. If a match is found it provides Vendor, OS, Generation, and device type.
```shell
nmap -O 6.2.9.5
```
##### Version scan
A version scan uses open ports and the nmap-service-probes databases to query services to confirm the service running on a port and provide the version of the service running. This allows exploits to be properly chosen for use since different versions and patches are susceptible to different things.
```shell
nmap -sV 10.30.50.70
```
##### Network sweep all IPs in a range
```shell
nmap -sn 10.10.10.1-253
```
##### Scan all IPs in a network and see their HTTP title
```
nmap -sV -sC {IP/CIDR}
```

___
## Flags
| Flag | Description                                                      |
| ---- | ---------------------------------------------------------------- |
| -n   | Disables name resolution                                         |
| -R   | Resolves names to IP addresses                                   |
| -iR  | Choose random targets                                            |
| -p   | Port ranges                                                      |
| -p-  | scan ALL ports                                                   |
| -F   | Fast mode                                                        |
| -v   | Verbosity level                                                  |
| -d   | Debugging level                                                  |
| -6   | IPv6 scanning                                                    |
| -A   | OS detection, version detection, script scanning, and traceroute |
>[!info] Scripts are stored in a subdirectory of the Nmap data directory by default: `/usr/share/nmap/scripts`

>[!warning] Quite a few Nmap scanning options require access to raw sockets, which in turn require root privileges.

___
## Useful NSE Scripts

##### Find scripts related to a topic
```
ls -1 /usr/share/nmap/scripts/smb*
```
##### dns-brute.nse
Attempts to enumerate DNS hostnames by brute force guessing of common subdomains.
```bash
nmap -p 80 --script dns-brute.nse $domain
```
##### http-enum.nse
Enumerates directories used by popular web applications and servers.
```bash
nmap -sV --script=http-enum $domain
```
## Attachments

![[NMAP cheat sheet.png]]